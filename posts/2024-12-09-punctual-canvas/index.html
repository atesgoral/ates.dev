<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta property="og:title" content="Punctual Canvas Rendering" />
    <meta property="og:type" content="article" />
    <meta property="og:description" content="The techniques I use for punctual canvas rendering, to maintain a consistent frame rate." />
    
    <meta
      property="og:image"
      content="https://ates.dev/posts/2024-12-09-punctual-canvas/i/punctual-canvas.png"
    />
    <meta property="og:image:alt" content="" />
    
    <meta property="og:locale" content="en_CA" />
    <meta property="og:site_name" content="ates.dev" />
    <title>ates.dev &middot; Punctual Canvas Rendering</title>
    <script>
      (() => {
        const themeOverride = localStorage.getItem('theme-override');
        const lightMode = themeOverride && themeOverride === 'light';
        document.documentElement.classList.toggle('light-mode', lightMode);
      })();
    </script>
    <link
      rel="preload"
      href="/assets/fonts/varelaround-regular-webfont.woff2"
      as="font"
      crossorigin="anonymous"
    />
    <link
      rel="preload"
      href="/assets/logos/bluesky.svg"
      as="image"
      crossorigin="anonymous"
    />
    <link
      rel="preload"
      href="/assets/logos/github.svg"
      as="image"
      crossorigin="anonymous"
    />
    <link
      rel="icon"
      type="image/png"
      href="/assets/icons/favicon-96x96.png"
      sizes="96x96"
    />
    <link rel="icon" type="image/svg+xml" href="/assets/icons/favicon.svg" />
    <link rel="shortcut icon" href="/assets/icons/favicon.ico" />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="/assets/icons/apple-touch-icon.png"
    />
    <meta name="apple-mobile-web-app-title" content="ates.dev" />
    <link rel="manifest" href="/assets/icons/site.webmanifest" />
    <link rel="stylesheet" href="/styles/style.css" />
    <link rel="me" href="https://bsky.app/profile/ates.dev" />
    <link rel="me" href="https://www.dwitter.net/u/magna" />
    <link rel="me" href="https://github.com/atesgoral" />
    <link rel="me" href="https://www.npmjs.com/~atesgoral" />
    <link rel="me" href="https://hackaday.io/atesgoral" />
    <link rel="me" href="https://www.instagram.com/atesgoral" />
    <link rel="me" href="https://stackoverflow.com/users/23501/ates-goral" />
    <link rel="me" href="https://www.linkedin.com/in/atesgoral/" />
    <link rel="me" href="https://twitter.com/atesgoral" />
    <link rel="me" href="https://x.com/atesgoral" />
    <script src="/assets/js/prog.js?bust=1"></script>
  </head>
  <body>
    
    <header>
      <h1>
        <a href="/">ates.dev</a>
      </h1>
      <nav>
        <ul>
          <li>
            <a href="/">Home</a>
          </li>
          <li>
            <a
              href="/pages/all-posts"
              >Posts</a
            >
          </li>
          <li>
            <a
              href="/pages/all-pages"
              >Pages</a
            >
          </li>
          <li>
            <a
              href="/pages/about"
              >About</a
            >
          </li>
          <li class="break"></li>
          <li>
            <a
              href="https://bsky.app/profile/ates.dev"
              rel="me"
              class="bluesky logo"
              >Bluesky</a
            >
          </li>
          <li>
            <a href="https://github.com/atesgoral" rel="me" class="github logo"
              >GitHub</a
            >
          </li>
        </ul>
      </nav>
    </header>

    <main>
<article>
  <h2>Punctual Canvas Rendering</h2>
  <p class="meta">Posted on Dec 09, 2024</p>

  <div class="content"><h3 id="time" tabindex="-1"><a class="permalink" href="#time">Time</a></h3>
<p>Let's get moving!</p>
<p class="canvas-container">
  <canvas id="canvas-starfield" class="fit black"></canvas>
</p>
<script>
  render('canvas-starfield', {
    init: (canvas, _ctx) => {
      const {width, height} = canvas.getBoundingClientRect();

      const dpr = window.devicePixelRatio;

      canvas.width = width * dpr;
      canvas.height = height * dpr;

      const STAR_COUNT = 50;

      this.stars ||= Array(STAR_COUNT).fill().map(() => ({
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height,
        z: Math.random()
      }));
    },
    draw: (ctx) => {
      const canvas = ctx.canvas;
      const dpr = window.devicePixelRatio;

      const SIZE = 5;
      const VELOCITY = 3;
      const PERSPECTIVE = 5;

      ctx.fillStyle = 'black';
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      ctx.fillStyle = 'white';

      for (const star of this.stars) {
        const {x, y, z} = star;
        const size = SIZE / (1 + z * PERSPECTIVE);

        ctx.fillRect(
          x - size / 2 * dpr,
          y - size / 2 * dpr,
          size * dpr,
          size * dpr
        )

        star.x = (star.x + VELOCITY * (1 - z)) % canvas.width;
      }
    }
  });
</script>
</div>

  
</article>
</main>

    <footer>
      <hr />
      <p class="footer meta">
        &copy; Ate<span class="sh">s</span> GÃ¶ral &middot;
        <a href="https://github.com/atesgoral/ates.dev">src</a> &middot;
        <a href="https://www.11ty.dev/">11ty</a>
      </p>
    </footer>
  </body>
</html>
