<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta property="og:title" content="A Short Introduction to Dwitter and JavaScript Golfing" />
    <meta property="og:type" content="article" />
    <meta property="og:description" content="A very short introduction to JavaScript golfing on Dwitter, with a focus on the "default dweet"." />
    
    <meta
      property="og:image"
      content="https://ates.dev/posts/2024-12-20-intro-to-dwitter/i/default-dweet.png"
    />
    <meta property="og:image:alt" content="" />
    
    <meta property="og:locale" content="en_CA" />
    <meta property="og:site_name" content="ates.dev" />
    <title>ates.dev &middot; A Short Introduction to Dwitter and JavaScript Golfing</title>
    <script>
      (() => {
        const themeOverride = localStorage.getItem('theme-override');
        const lightMode = themeOverride && themeOverride === 'light';
        document.documentElement.classList.toggle('light-mode', lightMode);
      })();
    </script>
    <link
      rel="preload"
      href="/assets/fonts/varelaround-regular-webfont.woff2"
      as="font"
      crossorigin="anonymous"
    />
    <link
      rel="preload"
      href="/assets/logos/bluesky.svg"
      as="image"
      crossorigin="anonymous"
    />
    <link
      rel="preload"
      href="/assets/logos/github.svg"
      as="image"
      crossorigin="anonymous"
    />
    <link
      rel="icon"
      type="image/png"
      href="/assets/icons/favicon-96x96.png"
      sizes="96x96"
    />
    <link rel="icon" type="image/svg+xml" href="/assets/icons/favicon.svg" />
    <link rel="shortcut icon" href="/assets/icons/favicon.ico" />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="/assets/icons/apple-touch-icon.png"
    />
    <meta name="apple-mobile-web-app-title" content="ates.dev" />
    <link rel="manifest" href="/assets/icons/site.webmanifest" />
    <link rel="stylesheet" href="/styles/style.css" />
    <link rel="me" href="https://bsky.app/profile/ates.dev" />
    <link rel="me" href="https://www.dwitter.net/u/magna" />
    <link rel="me" href="https://github.com/atesgoral" />
    <link rel="me" href="https://www.npmjs.com/~atesgoral" />
    <link rel="me" href="https://hackaday.io/atesgoral" />
    <link rel="me" href="https://www.instagram.com/atesgoral" />
    <link rel="me" href="https://stackoverflow.com/users/23501/ates-goral" />
    <link rel="me" href="https://www.linkedin.com/in/atesgoral/" />
    <link rel="me" href="https://twitter.com/atesgoral" />
    <link rel="me" href="https://x.com/atesgoral" />
    <link rel="me" href="https://mastodon.social/@magna" />
    <link
      rel="alternate"
      type="application/rss+xml"
      title="RSS Feed"
      href="/feed.xml"
    />
    <script src="/assets/js/prog.js?bust=1"></script>
  </head>
  <body>
    
    <script src="/lib/render.js"></script>
    
    <script src="/lib/dweet.js"></script>
    
    <header>
      <h1>
        <a href="/">ates.dev</a>
      </h1>
      <nav>
        <ul>
          <li>
            <a href="/">Home</a>
          </li>
          <li>
            <a
              href="/pages/all-posts"
              >Posts</a
            >
          </li>
          <li>
            <a
              href="/pages/all-pages"
              >Pages</a
            >
          </li>
          <li>
            <a
              href="/pages/about"
              >About</a
            >
          </li>
          <li class="break"></li>
          <li>
            <a
              href="https://bsky.app/profile/ates.dev"
              rel="me"
              class="bluesky logo"
              >Bluesky</a
            >
          </li>
          <li>
            <a href="https://github.com/atesgoral" rel="me" class="github logo"
              >GitHub</a
            >
          </li>
          <li>
            <a href="/feed.xml" rel="me" class="rss logo">RSS</a>
          </li>
        </ul>
      </nav>
    </header>

    <main>
<article>
  <h2>A Short Introduction to Dwitter and JavaScript Golfing</h2>
  <p class="meta">Posted on Dec 20, 2024</p>

  <div class="content"><p>This is a brief introduction to <a href="https://en.wikipedia.org/wiki/Code_golf">JavaScript golfing</a> — not the competitive
kind, but the kind on <a href="https://www.dwitter.net/">Dwitter</a>: a community for sharing visual JavaScript
demos in 140 characters.</p>
<p>The Dwitter community has a friendly and collaborative remix culture (where
users &quot;fork&quot; each other's works and build on them). And there's also a culture
of sharing tips and tricks.</p>
<p>Sidestepping the numerous online resources for writing unreadably compact
JavaScript, I will share the tricks I know and use, and try to present them in
a progressive manner.</p>
<p class="meta">Check out my originals and remixes
over at Dwitter under "<a href="https://www.dwitter.net/u/magna/top">magna</a>" to see some of these tricks in action.</p>
<h3 id="dweet" tabindex="-1"><a class="permalink" href="#dweet">Dweet</a></h3>
<p>Demos posted on Dwitter are called &quot;dweets&quot;. The premise is, there's a rendering
loop that keeps calling the function <code>u(t)</code> where <code>t</code> is time in seconds since
the start of the demo, and you have to fit function <code>u</code>'s body into 140
characters.</p>
<p>You're using the <code>&lt;canvas&gt;</code> API, with a 2D context. Dwitter gives you the
following global variables:</p>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>c</code></td>
<td>the 1920x1080 canvas element</td>
</tr>
<tr>
<td><code>x</code></td>
<td>the 2D context</td>
</tr>
<tr>
<td><code>S</code></td>
<td>the sine function (<code>Math.sin</code>)</td>
</tr>
<tr>
<td><code>C</code></td>
<td>the cosine function (<code>Math.cos</code>)</td>
</tr>
<tr>
<td><code>T</code></td>
<td>the tangent function (<code>Math.tan</code>)</td>
</tr>
<tr>
<td><code>R</code></td>
<td>a function for creating RGBA colors</td>
</tr>
<tr>
<td><code>frame</code></td>
<td>a counter, incremented on each frame</td>
</tr>
</tbody>
</table>
<p>The <code>R</code> function takes four optional parameters: red, green, blue, and alpha. e.g. <code>R(255, 0, 0, 0.5)</code> is a semi-transparent red color. Skipped arguments default to 0 except for alpha, which defaults to 1.</p>
<h3 id="the-default-scene" tabindex="-1"><a class="permalink" href="#the-default-scene">The default scene</a></h3>
<p>When you hit the <strong>New</strong> button on Dwitter, you're presented with this default
scene:</p>
<pre class="dweet play"><code class="language-js">c.width=1920 // clear the canvas
for(i=0;i<9;i++)
x.fillRect(400+i*100+S(t)*300,400,50,200) // draw 50x200 rects
</code></pre>
<p>9 black rectangles, swaying back and forth, following a sine wave.</p>
<p>This default scene is the main subject of many dweets, employing different
creative/surprising techniques to draw the rectangles. Or a subject that makes
a sudden entrance into an existing scene through a remix.</p>
<p>It's a Dwitter meme.</p>
<p>The default dweet is 112 characters in its initial form. Let's start shaving
some characters off, bit by bit.</p>
<h3 id="obvious-things" tabindex="-1"><a class="permalink" href="#obvious-things">Obvious things</a></h3>
<p>Let's start with the banally obvious: Remove comments and whitespace.</p>
<pre class="dweet"><code class="language-js">c.width=1920;for(i=0;i<9;i++)x.fillRect(400+i*100+S(t)*300,400,50,200)
</code></pre>
<p>We're down to 70.</p>
<h3 id="idempotency" tabindex="-1"><a class="permalink" href="#idempotency">Idempotency</a></h3>
<p>Assigning the width or height of a canvas resets the canvas, even if the value
is the same as the current value.</p>
<p>That's why the default scene sets the canvas width to 1920: To clear the canvas
before drawing each frame.</p>
<p>But what we really need is a no-op assignment to clear the canvas. Any
idempotent operation will do. So we can binary OR the canvas width with 0:</p>
<pre><code class="language-js">c.width=19<span class="remove">20</span>
c.width|=0
</code></pre>
<p>We shave another 2 characters off.</p>
<p>We could have added 0 or multiplied by 1. You get the idea.</p>
<h3 id="loop-inversion" tabindex="-1"><a class="permalink" href="#loop-inversion">Loop inversion</a></h3>
<p>When loop order is unimportant, we can invert loops to shave characters.</p>
<pre><code class="language-js">for(i=0;i<9;i<span class="remove">++)</span>
for(i=9;i--;)
</code></pre>
<p>We shave 3 characters off.</p>
<pre class="dweet"><code class="language-js">c.width|=0;for(i=9;i--;)x.fillRect(400+i*100+S(t)*300,400,50,200)
</code></pre>
<p>Down to 65.</p>
<p>This is the maximum we can shave off, without resorting to other API methods, or
starting to mess with the scene composition.</p>
<h3 id="compromising" tabindex="-1"><a class="permalink" href="#compromising">Compromising</a></h3>
<p>Well, we often can mess with the scene composition. We can compromise accuracy
when the result is visually indistinguishable.</p>
<p>OR'ing with 0 is idempotent. So is OR'ing with 9, when we're willing to
compromise and accept 1929 as the new 1920.</p>
<p>OR'ing with 9 results in 1929 (<code>1920 | 9</code>), but the 9-pixel difference is imperceptible.</p>
<pre><code class="language-js">c.width|=0;for(i=9;i--<span class="remove">;)</span>
for(c.width|=i=9;i--;)
</code></pre>
<p>We shave another 2 characters off.</p>
<pre class="dweet play"><code class="language-js">for(c.width|=i=9;i--;)x.fillRect(400+i*100+S(t)*300,400,50,200)
</code></pre>
<p>Down to 63.</p>
<p>And with that, one Dwitter article down, <code>n</code> to go.</p>
</div>

  
  <h3>Discourse</h3>
  <p class="meta">
    Comments, questions, corrections? Please drop them on
    <a href="https://bsky.app/profile/ates.dev/post/3ldou6c244k2x">Bluesky!</a>
  </p>
  
</article>
</main>

    <footer>
      <hr />
      <p class="footer meta">
        &copy; Ateş Göral &middot;
        <a href="https://github.com/atesgoral/ates.dev">src</a> &middot;
        <a href="https://www.11ty.dev/">11ty</a>
      </p>
    </footer>

    <div id="dweet-length-template" style="display: none">
      <div class="length"><span></span>/140</div>
    </div>

    <div id="dweet-player-template" style="display: none">
      <p class="canvas-container">
        <span class="canvas-subcontainer dweet-container">
          <canvas class="white" width="1920" height="1080"></canvas>
        </span>
      </p>
    </div>
  </body>
</html>
