<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta property="og:title" content="Multiple Synthetic Lights" />
    <meta property="og:type" content="article" />
    <meta property="og:description" content="" />
    
    <meta
      property="og:image"
      content="https://ates.dev/pages/multiple-synthetic-lights/i/lighting-09.jpg"
    />
    <meta property="og:image:alt" content="" />
    
    <meta property="og:locale" content="en_CA" />
    <meta property="og:site_name" content="ates.dev" />
    <title>ates.dev &middot; Multiple Synthetic Lights</title>
    <script>
      (() => {
        const themeOverride = localStorage.getItem('theme-override');
        const lightMode = themeOverride && themeOverride === 'light';
        document.documentElement.classList.toggle('light-mode', lightMode);
      })();
    </script>
    <link
      rel="preload"
      href="/assets/fonts/varelaround-regular-webfont.woff2"
      as="font"
      crossorigin="anonymous"
    />
    <link
      rel="preload"
      href="/assets/logos/bluesky.svg"
      as="image"
      crossorigin="anonymous"
    />
    <link
      rel="preload"
      href="/assets/logos/github.svg"
      as="image"
      crossorigin="anonymous"
    />
    <link
      rel="icon"
      type="image/png"
      href="/assets/icons/favicon-96x96.png"
      sizes="96x96"
    />
    <link rel="icon" type="image/svg+xml" href="/assets/icons/favicon.svg" />
    <link rel="shortcut icon" href="/assets/icons/favicon.ico" />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="/assets/icons/apple-touch-icon.png"
    />
    <meta name="apple-mobile-web-app-title" content="ates.dev" />
    <link rel="manifest" href="/assets/icons/site.webmanifest" />
    <link rel="stylesheet" href="/styles/style.css" />
    <link rel="me" href="https://bsky.app/profile/ates.dev" />
    <link rel="me" href="https://www.dwitter.net/u/magna" />
    <link rel="me" href="https://github.com/atesgoral" />
    <link rel="me" href="https://www.npmjs.com/~atesgoral" />
    <link rel="me" href="https://hackaday.io/atesgoral" />
    <link rel="me" href="https://www.instagram.com/atesgoral" />
    <link rel="me" href="https://stackoverflow.com/users/23501/ates-goral" />
    <link rel="me" href="https://www.linkedin.com/in/atesgoral/" />
    <link rel="me" href="https://twitter.com/atesgoral" />
    <link rel="me" href="https://x.com/atesgoral" />
    <script src="/assets/js/prog.js?bust=1"></script>
  </head>
  <body>
    
    <script src="/lib/render.js"></script>
    
    <header>
      <h1>
        <a href="/">ates.dev</a>
      </h1>
      <nav>
        <ul>
          <li>
            <a href="/">Home</a>
          </li>
          <li>
            <a
              href="/pages/all-posts"
              >Posts</a
            >
          </li>
          <li>
            <a
              href="/pages/all-pages"
              >Pages</a
            >
          </li>
          <li>
            <a
              href="/pages/about"
              >About</a
            >
          </li>
          <li class="break"></li>
          <li>
            <a
              href="https://bsky.app/profile/ates.dev"
              rel="me"
              class="bluesky logo"
              >Bluesky</a
            >
          </li>
          <li>
            <a href="https://github.com/atesgoral" rel="me" class="github logo"
              >GitHub</a
            >
          </li>
        </ul>
      </nav>
    </header>

    <main>
<article>
  <h2>Multiple Synthetic Lights</h2>

  <div class="content"><p>Multiple photographs taken with different light sources can be blended together to create images that appear to have all the light sources simultaneously active. The light sources can be attributed arbitrary colors as well, allowing the creation of an infinite number of synthetic scenes.</p>
<p>Quoting from <a href="https://www.graficaobscura.com/synth/">Synthetic Lighting for Photography</a> by Paul Haeberli:</p>
<blockquote>
<p>Light from different light sources add together to illuminate objects in a scene. We can use this super-position principle to modify the lighting of a scene after it has been photographed...</p>
</blockquote>
<p>I've created an interactive application with three light sources with different colors.</p>
<p class="canvas-container" style="height: auto; padding: 0.5rlh;">
  <canvas id="canvas" width="250" height="250" style="cursor: crosshair;"></canvas>
</p>
<script type="module">
  async function loadImage(src) {
    const img = new Image();
    img.src = src;
    img.crossOrigin = 'anonymous';

    await img.decode();

    return img;
  }

  function getImageData(img) {
    const canvas = document.createElement('canvas');
    canvas.width = img.width;
    canvas.height = img.height;

    const ctx = canvas.getContext('2d');
    ctx.drawImage(img, 0, 0);

    return ctx.getImageData(0, 0, img.width, img.height).data;
  }

  render('canvas', {
    async init(canvas, ctx) {
      canvas.addEventListener('pointermove', (e) => {
        this.mouseX = Math.max(0, e.offsetX);
        this.mouseY = Math.max(0, e.offsetY);
      });

      const imgAmb = await loadImage('i/lighting-11.jpg');
      const imgA = await loadImage('i/lighting-09.jpg');
      const imgB = await loadImage('i/lighting-10.jpg');
      const imgC = await loadImage('i/lighting-14.jpg');

      this.dataAmb = getImageData(imgAmb);
      this.dataA = getImageData(imgA);
      this.dataB = getImageData(imgB);
      this.dataC = getImageData(imgC);

      this.ready = true;

      this.mouseX = 125;
      this.mouseY = 125;
    },
    draw(ctx, t) {
      if (!this.ready) return;

      if (this.pmouseX === this.mouseX && this.pmouseY === this.mouseY) return;

      this.pmouseX = this.mouseX;
      this.pmouseY = this.mouseY;

      const normX = this.mouseX / 250;
      const normY = this.mouseY / 250;

      const coeffA = Math.sqrt(1 - normX);
      const coeffB = 1 - normY;
      const coeffC = Math.sqrt(normX);

      const colorAmb = [0x20, 0x2A, 0x35];
      const colorA = [0x7F, 0x10, 0x25];
      const colorB = [0x8A, 0x87, 0x68];
      const colorC = [0x29, 0x1D, 0x80];

      const imageData = new ImageData(250, 250);

      for (let i = 0; i < imageData.data.length; i++) {
        const comp = i % 4;

        if (comp < 3) {
          imageData.data[i] = (this.dataAmb[i] * colorAmb[comp]
            + this.dataA[i] * colorA[comp] * coeffA
            + this.dataB[i] * colorB[comp] * coeffB
            + this.dataC[i] * colorC[comp] * coeffC) / 255;
        } else {
          imageData.data[i] = 255;
        }
      }

      ctx.putImageData(imageData, 0, 0);
    },
  });
</script>
<p>Hover over the image to change the intensities of the three light sources.</p>
<p>This was originally done using <a href="https://processing.org/">Processing</a>, then ported to Processing.js (deprecated), then ported to <a href="https://p5js.org/">p5.js</a>, and then finally directly done with plain old <code>&lt;canvas&gt;</code> and JavaScript.</p>
<p>The images I've used are below. They're taken from <a href="https://web.archive.org/web/20071207230006/www.megapixel.net/html/articles/article-lightdir.php">this article about lighting direction</a>.</p>
<p class="center zoomable">
  <img src="i/lighting-11.jpg" alt="Ambient light">
</p>
<p class="center zoomable">
  <img src="i/lighting-09.jpg" alt="Light coming from the left">
</p>
<p class="center zoomable">
  <img src="i/lighting-10.jpg" alt="Light coming from the top">
</p>
<p class="center zoomable">
  <img src="i/lighting-14.jpg" alt="Light coming from the right">
</p>
</div>
</article>
</main>

    <footer>
      <hr />
      <p class="footer meta">
        &copy; Ate<span class="sh">s</span> GÃ¶ral &middot;
        <a href="https://github.com/atesgoral/ates.dev">src</a> &middot;
        <a href="https://www.11ty.dev/">11ty</a>
      </p>
    </footer>

    <div id="dweet-length-template" style="display: none">
      <div class="length"><span></span>/140</div>
    </div>

    <div id="dweet-player-template" style="display: none">
      <p class="canvas-container">
        <span class="canvas-subcontainer dweet-container">
          <canvas class="white" width="1920" height="1080"></canvas>
        </span>
      </p>
    </div>
  </body>
</html>
